<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Amazon Payment Demo</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->


    <!-- build:css styles/vendor.css -->
    <!-- bower:css -->
    <link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.css" />
    <!-- endbower -->
    <!-- endbuild -->
    <!-- build:css styles/main.css -->
    <link rel="stylesheet" href="styles/main.css">
    <!-- endbuild -->

    <!-- build:js scripts/vendor/modernizr.js -->
    <script src="bower_components/modernizr/modernizr.js"></script>
    <script src="bower_components/jquery/src/jquery.js"></script>
    <script src="bower_components/bootstrap/dist/js/bootstrap.js"></script>


    <script type='text/javascript'>
        function getURLParameter(name, source) {
            return decodeURIComponent((new RegExp('[?|&|#]' + name + '=' +
                    '([^&;]+?)(&|#|;|$)').exec(source)||[,""])[1].replace(/\+/g,'%20'))||null; }
        var accessToken = getURLParameter("access_token", location.hash);
        if (typeof accessToken === 'string' && accessToken.match(/^Atza/)) {
            document.cookie = "amazon_Login_accessToken=" + accessToken + ";secure";}
        window.onAmazonLoginReady = function() {
            amazon.Login.setClientId('amzn1.application-oa2-client.ef5d46cbfd5249468432cda089d4fabd');
            amazon.Login.setUseCookie(true);  };
    </script>


    <script src="https://static-na.payments-amazon.com/OffAmazonPayments/us/sandbox/js/Widgets.js?sellerId=A2ISLC14FJ2O0F"></script>

    <!-- endbuild -->
</head>
<body>
<div class="container">
    <div class="header">
        <ul class="nav nav-pills pull-right">
            <li class="active"><a href="#">Home</a></li>
        </ul>
        <h3 class="text-muted">Amazon Payment Demo</h3>

        <div id="walletWidgetDiv" style="width: 400px; height: 228px"></div>


        <div class="footer">

        </div>
    </div>

    <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->


    <!-- build:js scripts/vendor.js -->
    <!-- bower:js -->

    <!-- endbower -->
    <!-- endbuild -->

    <!-- build:js scripts/plugins.js -->


    <!-- endbuild -->



    <script>
        /*   function getHashParams() {

         var hashParams = {};
         var e,
         a = /\+/g,  // Regex for replacing addition symbol with a space
         r = /([^&;=]+)=?([^&;]*)/g,
         d = function (s) { return decodeURIComponent(s.replace(a, " ")); },
         q = window.location.hash.substring(1);

         while (e = r.exec(q))
         hashParams[d(e[1])] = d(e[2]);

         return hashParams;
         }*/

        //  $(document).ready(function (){
        //  var params = getHashParams();
        //  alert("The access token is "+ params.access_token);

        /* $.ajax("https://api.amazon.com/auth/o2/tokeninfo?access_token="+params.access_token, {
         type: "GET",
         cache:false,
         dataType: 'json',
         contentType: 'application/json; charset=utf-8',
         success: function (msg) {
         debugger;
         console.log(msg);*/

        //  if(msg && msg.aud && msg.aud=="amzn1.application-oa2-client.ef5d46cbfd5249468432cda089d4fabd"){

        new OffAmazonPayments.Widgets.Wallet({ sellerId: 'A2ISLC14FJ2O0F',
            onOrderReferenceCreate: function(orderReference) {
                orderReference.getAmazonOrderReferenceId();
            },
            design: {
                designMode: 'responsive'
            },
            onPaymentSelect: function(orderReference) {
                // Replace this code with the action that you want to perform
            },// after the payment method is selected.
            onError: function(error) {
                // your error handling code
            }
        }).bind("walletWidgetDiv");



        /*   } else {
         alert("Invalid  response");
         }*/
        //  },
        /*    error: function (resp){
         var responseObj = JSON.parse(resp.responseText);
         responseObj.message && alert( responseObj.message );
         }*/

        //    });
        //     });
    </script>
</div>
</body>
</html>